<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-advanced-guide/query-optimiser">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Query Optimizer | INOS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://inos2023.github.io/en/img/编组4.svg"><meta data-rh="true" name="twitter:image" content="https://inos2023.github.io/en/img/编组4.svg"><meta data-rh="true" property="og:url" content="https://inos2023.github.io/en/docs/advanced-guide/query-optimiser"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Query Optimizer | INOS"><meta data-rh="true" name="description" content="The optimizer is the core of the database system. An excellent optimizer can greatly improve query performance, especially in complex query scenarios. The optimizer can bring performance improvements of several to hundreds of times."><meta data-rh="true" property="og:description" content="The optimizer is the core of the database system. An excellent optimizer can greatly improve query performance, especially in complex query scenarios. The optimizer can bring performance improvements of several to hundreds of times."><link data-rh="true" rel="icon" href="/en/img/01-1LOGO.svg"><link data-rh="true" rel="canonical" href="https://inos2023.github.io/en/docs/advanced-guide/query-optimiser"><link data-rh="true" rel="alternate" href="https://inos2023.github.io/en/docs/advanced-guide/query-optimiser" hreflang="en"><link data-rh="true" rel="alternate" href="https://inos2023.github.io/docs/advanced-guide/query-optimiser" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://inos2023.github.io/docs/advanced-guide/query-optimiser" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="INOS RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="INOS Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BYY7CCPJZ6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BYY7CCPJZ6",{})</script><link rel="stylesheet" href="/en/assets/css/styles.1ac17b15.css">
<link rel="preload" href="/en/assets/js/runtime~main.dd42e63f.js" as="script">
<link rel="preload" href="/en/assets/js/main.bb7ada30.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_Rzz1" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.png" alt="INOS Logo" class="themedImage_DeRy themedImage--light_hbln"><img src="/en/img/logo.png" alt="INOS Logo" class="themedImage_DeRy themedImage--dark_qgR1"></div><b class="navbar__title text--truncate">Intelligence Native Group</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/introduction/main-principle-concepts">Docs</a><a class="navbar__item navbar__link" href="/en/blogs">Blog</a><a class="navbar__item navbar__link" href="/en/community">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/inos2023?tab=repositories" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"><span>GitHub</span></a><a class="navbar__item navbar__link search-input" href="/en/docs/introduction/recommended-use-case"><div class="SearchBarClass"><img src="/img/01-11搜索.svg" width="18px" height="18px"><input class="inputClass" placeholder="搜索"></div></a><div class="toggle_HPIb colorModeToggle_KItF"><button class="clean-btn toggleButton_yRlM toggleButtonDisabled_oHIz" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Vljy"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_lcNQ"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_mmj0"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_NWrx docsWrapper_oNqO"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_LsNq" type="button"></button><div class="docPage_fHU4"><aside class="theme-doc-sidebar-container docSidebarContainer_jEGB"><div class="sidebarViewport_Gc0S"><div class="sidebar_uCr1"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_s63m"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/introduction/main-principle-concepts">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/quick-start/basic-database-operations">Quick Start</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/sql-syntax/ansi-compatibility">SQL Syntax</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/basic-guide/background-task-management">Basic Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/en/docs/advanced-guide/0.2.0_s3_upgrade_checklist">Advanced Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/0.2.0_s3_upgrade_checklist">Byconity 0.2.0 s3 storage upgrade checklist</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/background-task-configuration">Background Tasks Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/bucket-table-best-practice">Bucket table best practice manual</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/column-based-storage">Column Storage Design Principles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/complex-query-model-and-optimisation">Complex Query Models and Execution Tuning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/import-optimisation">Import Optimisation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/managing-concurrency">Transactions and Concurrency Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/advanced-guide/query-optimiser">Query Optimizer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/rbac">Role-based Access Control (RBAC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/advanced-guide/resource-manager">resource manager</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/community/become-maintainer">Community</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/deployment/deployment-requirements">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/meetup/gpgpu-related-tools">Meetup 活动</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_b8RI"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_QMJw"><div class="docItemContainer_EkDS"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_dvLu" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_ObZR"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Advanced Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Query Optimizer</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_Iw4v theme-doc-toc-mobile tocMobile_L4iJ"><button type="button" class="clean-btn tocCollapsibleButton_Omde">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Query Optimizer</h1><p>The optimizer is the core of the database system. An excellent optimizer can greatly improve query performance, especially in complex query scenarios. The optimizer can bring performance improvements of several to hundreds of times.</p><p>ByConity&#x27;s optimizer provides extreme optimization capabilities based on four major optimization directions:</p><ul><li>RBO: rule-based optimization capability. Support column pruning, partition pruning, expression simplification, subquery disassociation, predicate pushdown, redundant operator elimination, Outer-JOIN to INNER-JOIN, operator pushdown storage, distributed operator splitting, etc. Heuristic optimization capability.</li><li>CBO: Cost-based optimization capability. Support Join Reorder, Outer-Join Reorder, Join/Agg Reorder, CTE, materialized view, Dynamic Filter pushdown, Magic Set and other cost-based optimization capabilities. And it integrates Property Enforcement for distributed planning.</li><li>DBO: optimization capability based on data dependencies. Support unique key, functional dependency, Order dependency, Inclusion dependency and other optimization capabilities based on data dependencies.</li><li>HBO: Optimization capability based on query feedback. Support dynamic adjustment of cardinality estimation, dynamic adjustment of parallelism, dynamic adjustment of execution plan and other optimization capabilities based on historical execution feedback.</li></ul><h1>Turn on Query Optimizer</h1><p>set dialect_type =&#x27;ANSI&#x27; or set enable_optimizer =1</p><p>If turn on ANSI mode, the optimizer will be turned on automatically.</p><h1>Commands for collecting, displaying and deleting statistical information</h1><h2 class="anchor anchorWithStickyNavbar_B0by" id="syntax-definition">Syntax Definition<a href="#syntax-definition" class="hash-link" aria-label="Direct link to Syntax Definition" title="Direct link to Syntax Definition">​</a></h2><ul><li>Subsequent versions will have automatic collection, update and analysis of statistical information</li></ul><div class="codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-text codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain">-- NOTE: ALL means currentDatabase().*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--    specifying columns and sample config is supportted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STATS [IF NOT EXISTS] (&lt;db&gt;.* | ALL | [&lt;db&gt;.]&lt;table&gt;[&#x27;(&#x27; &lt;col1&gt;, &lt;col2&gt;, ..., &lt;coln&gt; &#x27;)&#x27;]) [WITH (FULLSCAN | SAMPLE [&lt;rows&gt; ROWS] [&lt;ratio&gt; RATIO])]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Delete statistics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--   specifying columns is supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DROP STATS (&lt;db&gt;.* | ALL | [&lt;db&gt;.]&lt;table&gt;[&#x27;(&#x27; &lt;col1&gt;, &lt;col2&gt;, ..., &lt;coln&gt; &#x27;)&#x27; ])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--   specifying columns is supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHOW (STATS|COLUMN_STATS) (&lt;db&gt;.* | ALL | [&lt;db&gt;.]&lt;table&gt;&#x27;(&#x27;&lt;col1&gt;, &lt;col2&gt;, ..., &lt;coln&gt; &#x27;)&#x27; )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_B0by" id="syntax-example">Syntax Example:<a href="#syntax-example" class="hash-link" aria-label="Direct link to Syntax Example:" title="Direct link to Syntax Example:">​</a></h2><h3 class="anchor anchorWithStickyNavbar_B0by" id="create-statistics">Create Statistics<a href="#create-statistics" class="hash-link" aria-label="Direct link to Create Statistics" title="Direct link to Create Statistics">​</a></h3><div class="codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-text codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- create stats for all table in current database which has no statistics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create stats if not exists all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- create stats for all table in db1 which has no statistics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create stats if not exists db1.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- create stats for t1.c1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create stats t1(c1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- create stats for t1.c1, t1.c2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create stats t1(c1, c2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- create stats on t1, force to use fullscan,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- otherwise controlled by statistics_enable_sample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create stats t1 with fullscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- sample MAX(**statistics_sample_row_count**, 0.01 * full_rows_count) rows when create stats for each table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create stats all with 0.01 ratio;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- sample MAX(40000000, 0.01 * full_rows_count) rows when create stats for each table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create stats all with 0.01 ratio 40000000 rows;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- sample with default settings,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- controlled by **statistics_sample_row_count** and **statistics_sample_ratio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create stats all with sample;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_B0by" id="show-statistics">Show Statistics<a href="#show-statistics" class="hash-link" aria-label="Direct link to Show Statistics" title="Direct link to Show Statistics">​</a></h3><div class="codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-text codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- show table statistics for all tables in current database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show stats all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- show table statistics for all tables in db1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show stats db1.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- show table statistics for table t1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show stats t1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- show column statistics for table t1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show column_stats t1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- show column statistics for column c1, c2 of table t1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show column_stats t1(c1, c2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_B0by" id="drop-statistics">Drop Statistics<a href="#drop-statistics" class="hash-link" aria-label="Direct link to Drop Statistics" title="Direct link to Drop Statistics">​</a></h3><div class="codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-text codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- show statistics for all tables in current database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drop stats all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- show statistics for all tables in db1.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drop stats db1.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- show statistics for table t1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drop stats t1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- drop statistics for column c1, c2 of table t1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drop stats t1(c1, c2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Usage of Explain</h1><h2 class="anchor anchorWithStickyNavbar_B0by" id="explain">Explain<a href="#explain" class="hash-link" aria-label="Direct link to Explain" title="Direct link to Explain">​</a></h2><ul><li>Explain + SQL</li></ul><div class="codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-text codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WITH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sr_customer_sk AS ctr_customer_sk,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sr_store_sk AS ctr_store_sk,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sum(sr_return_amt) AS ctr_total_return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FROM store_returns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        , date_dim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        WHERE (sr_returned_date_sk = d_date_sk) AND (d_year = 2000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GROUP BY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sr_customer_sk,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sr_store_sk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) AS customer_total_return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SELECT c_customer_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM customer_total_return AS ctr1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">, store</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">, customer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE (ctr1.ctr_total_return &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SELECT avg(ctr_total_return) * 1.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM customer_total_return AS ctr2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)) AND (s_store_sk = ctr1.ctr_store_sk) AND (s_state = &#x27;TN&#x27;) AND (ctr1.ctr_customer_sk = c_customer_sk)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ORDER BY c_customer_id ASC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIMIT 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Result of Explain</li></ul><p><img loading="lazy" src="/en/assets/images/boxcnbHJgX6mTV1MHFyLXajy23f-c0effcd2819edf7d1bb23755d9527e39.png" width="2008" height="1712" class="img_astN"></p><h2 class="anchor anchorWithStickyNavbar_B0by" id="explain-analyze"><strong>Explain Analyze</strong><a href="#explain-analyze" class="hash-link" aria-label="Direct link to explain-analyze" title="Direct link to explain-analyze">​</a></h2><p>Explain analyze + SQL</p><div class="codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-text codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN ANALYZE LOGICAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WITH customer_total_return AS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sr_customer_sk AS ctr_customer_sk,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sr_store_sk AS ctr_store_sk,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sum(sr_return_amt) AS ctr_total_return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FROM store_returns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        , date_dim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        WHERE (sr_returned_date_sk = d_date_sk) AND (d_year = 2000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GROUP BY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sr_customer_sk,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sr_store_sk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SELECT c_customer_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM customer_total_return AS ctr1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">, store</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">, customer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE (ctr1.ctr_total_return &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SELECT avg(ctr_total_return) * 1.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM customer_total_return AS ctr2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)) AND (s_store_sk = ctr1.ctr_store_sk) AND (s_state = &#x27;TN&#x27;) AND (ctr1.ctr_customer_sk = c_customer_sk)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ORDER BY c_customer_id ASC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIMIT 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-text codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain">┌─Explain Analyze──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Limit                                                                                                                                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ │     Est. 100 rows, cost 8.2e+05                                                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ │     Act. 100 rows (2.4 KB), Throughput: 545.0K rows/s, CPU Time per worker: avg 2.0 us, max 2.0 us, Wall Time: 1.8 ms                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ │     Filtered: 0.0%, QError: 1.0                                                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ └─ MergeSorting                                                                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │     Est. 49.2K rows, cost 8.2e+05                                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │     Act. 100 rows (2.4 KB), Throughput: 545.0K rows/s, CPU Time per worker: avg 2.0 us, max 2.0 us, Wall Time: 1.8 ms                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │     Filtered: 96.9%, QError: 504.1                                                                                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    └─ Union                                                                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │     Est. 49.2K rows, cost 8.2e+05                                                                                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │     Act. 3.1K rows (78.1 KB), Throughput: 17.0M rows/s, CPU Time per worker: avg 0.0 us, max 0.0 us, Wall Time: 1.8 ms                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │     Filtered: 0.0%, QError: 15.8                                                                                                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       └─ PartialSorting                                                                                                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          │     Est. 49.2K rows, cost 8.2e+05                                                                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          │     Act. 3.1K rows (78.1 KB), Throughput: 17.0M rows/s, CPU Time per worker: avg 40.0 us, max 40.0 us, Wall Time: 1.8 ms                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          │     Filtered: 0.0%, QError: 15.8                                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          └─ Gather Exchange                                                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     Est. 49.2K rows, cost 8.2e+05                                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             └─ MergeSorting                                                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                │     Est. 49.2K rows, cost 8.1e+05                                                                                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                │     Act. 12.5K rows (313.1 KB), Throughput: 108.2M rows/s, CPU Time per worker: avg 23.0 us, max 25.0 us, Wall Time: 1.2 ms                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                │     Filtered: -1.6%, QError: 3.9                                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                └─ PartialSorting                                                                                                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   │     Est. 49.2K rows, cost 8.1e+05                                                                                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   │     Act. 12.3K rows (308.3 KB), Throughput: 91.6M rows/s, CPU Time per worker: avg 40.0 us, max 40.0 us, Wall Time: 1.3 ms                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   │     Filtered: 0.0%, QError: 4.0                                                                                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   └─ Inner Join                                                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     Est. 47.5K rows, cost 8.1e+05                                                                                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     Act. 12.3K rows (308.3 KB), Throughput: 91.6M rows/s, CPU Time per worker: avg 41.6 ms, max 41.8 ms, Wall Time: 1.3 ms                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     Filtered: 0.0%, QError: 3.9                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     Condition: sr_store_sk_1 == s_store_sk                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     Filter: `sum(sr_return_amt)_1` &gt; (`avg(ctr_total_return)` * 1.2)                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      ├─ Local Exchange                                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │  │     Est. 49.2K rows, cost 2.9e+05                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │  └─ Inner Join                                                                                                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │     Est. 49.2K rows, cost 2.9e+05                                                                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │     Act. 49.3K rows (2.1 MB), Throughput: 542.3M rows/s, CPU Time per worker: avg 6.2 ms, max 6.4 ms, Wall Time: 896.0 us               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │     Filtered: 0.0%, QError: 1.0                                                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │     Condition: c_customer_sk == sr_customer_sk_1                                                                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     ├─ Repartition Exchange                                                                                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │  │     Est. 97.7K rows, cost 9.0e+04                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │  │     Partition by: {c_customer_sk}                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │  └─ ReadFromStorage tpcds.customer                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │           Est. 97.7K rows, cost 7.4e+04                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │           Act. 97.7K rows (3.1 MB), Throughput: 22.2G rows/s, CPU Time per worker: avg 362.0 us, max 402.0 us, Wall Time: 47.0 us       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     │           Filtered: 0.0%, QError: 1.0                                                                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     └─ Repartition Exchange                                                                                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │        │     Est. 50.9K rows, cost 6.1e+04                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │        │     Partition by: {sr_customer_sk_1}                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │        └─ CTERef [0]                                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │                 Est. 50.9K rows, cost 5.2e+04                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      └─ Broadcast Exchange                                                                                                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │     Est. 7 rows, cost 5.6e+04                                                                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         └─ Inner Join                                                                                                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     Est. 7 rows, cost 5.6e+04                                                                                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     Act. 6 rows (102.0 Bytes), Throughput: 67.7K rows/s, CPU Time per worker: avg 280.0 us, max 360.0 us, Wall Time: 870.0 us           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     Filtered: 97.9%, QError: 1.2                                                                                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     Condition: s_store_sk == sr_store_sk_2                                                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            ├─ Repartition Exchange                                                                                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │  │     Est. 12 rows, cost 1.2e+01                                                                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │  │     Partition by: {s_store_sk}                                                                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │  └─ Filter                                                                                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     │     Est. 12 rows, cost 9.8e+00                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     │     Act. 12 rows (240.0 Bytes), Throughput: 28.6M rows/s, CPU Time per worker: avg 16.0 us, max 24.0 us, Wall Time: 5.0 us        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     │     Filtered: 0.0%, QError: 1.0                                                                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     │     s_state = &#x27;TN&#x27;                                                                                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │     └─ ReadFromStorage tpcds.store                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │              Est. 12 rows, cost 8.9e+00                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │              Act. 12 rows (240.0 Bytes), Throughput: 28.6M rows/s, CPU Time per worker: avg 48.0 us, max 72.0 us, Wall Time: 4.0 us     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            │              Filtered: 0.0%, QError: 1.0                                                                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            └─ MergingAggregated                                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                               │     Est. 6 rows, cost 5.6e+04                                                                                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                               │     Act. 280 rows (4.9 KB), Throughput: 3.1M rows/s, CPU Time per worker: avg 60.0 us, max 80.0 us, Wall Time: 867.0 us              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                               │     Filtered: 0.0%, QError: 46.7                                                                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                               └─ Repartition Exchange                                                                                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                  │     Est. 6 rows, cost 5.6e+04                                                                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                  │     Partition by: {sr_store_sk_2}                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                  └─ Aggregating                                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                     │     Est. 6 rows, cost 5.6e+04                                                                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                     │     Act. 14 rows (238.0 Bytes), Throughput: 145.6K rows/s, CPU Time per worker: avg 7.0 us, max 9.0 us, Wall Time: 955.0 us    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                     │     Filtered: 100.0%, QError: 2.3                                                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                     │     Group by: {sr_store_sk_2}                                                                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                     └─ Projection                                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                        │     Est. 50.9K rows, cost 5.6e+04                                                                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                        │     Act. 49.3K rows (887.4 KB), Throughput: 519.5M rows/s, CPU Time per worker: avg 0.0 us, max 0.0 us, Wall Time: 947.0 us │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                        │     Filtered: 0.0%, QError: 1.0                                                                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                        └─ CTERef [0]                                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                 Est. 50.9K rows, cost 5.2e+04                                                                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ CTEDef [0]                                                                                                                                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    MergingAggregated                                                                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │     Est. 50.9K rows, cost 4.3e+05                                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │     Act. 49.3K rows (1.3 MB), Throughput: 497.5M rows/s, CPU Time per worker: avg 34.0 us, max 35.0 us, Wall Time: 996.0 us                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │     Filtered: 0.0%, QError: 1.0                                                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    └─ Repartition Exchange                                                                                                                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │     Est. 50.9K rows, cost 4.3e+05                                                                                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │     Partition by: {sr_customer_sk, sr_store_sk}                                                                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       └─ Aggregating                                                                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          │     Est. 50.9K rows, cost 4.2e+05                                                                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          │     Act. 51.4K rows (1.3 MB), Throughput: 1.1G rows/s, CPU Time per worker: avg 27.0 us, max 28.0 us, Wall Time: 506.0 us                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          │     Filtered: 5.8%, QError: 1.0                                                                                                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          │     Group by: {sr_customer_sk, sr_store_sk}                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          └─ Inner Join                                                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     Est. 50.9K rows, cost 4.2e+05                                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     Act. 54.5K rows (1.4 MB), Throughput: 1.2G rows/s, CPU Time per worker: avg 14.3 ms, max 15.0 ms, Wall Time: 477.0 us                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     Filtered: -90.6%, QError: 1.1                                                                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     Condition: sr_returned_date_sk == d_date_sk                                                                                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             ├─ Local Exchange                                                                                                                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │  │     Est. 280.8K rows, cost 2.3e+05                                                                                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │  └─ Filter                                                                                                                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     │     Est. 280.8K rows, cost 2.3e+05                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     │     Act. 54.5K rows (1.9 MB), Throughput: 5.7G rows/s, CPU Time per worker: avg 865.0 us, max 885.0 us, Wall Time: 96.0 us                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     │     Filtered: 0.0%, QError: 5.2                                                                                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     │     Dynamic Filters: {sr_returned_date_sk:range}                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │     └─ ReadFromStorage tpcds.store_returns                                                                                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │              Est. 280.8K rows, cost 2.1e+05                                                                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │              Act. 54.5K rows (1.9 MB), Throughput: 5.8G rows/s, CPU Time per worker: avg 2.4 ms, max 2.4 ms, Wall Time: 95.0 us                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             │              Filtered: 0.0%, QError: 5.2                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│             └─ Projection                                                                                                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                │     Est. 366 rows, cost 6.0e+04                                                                                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                │     Act. 28.6K rows (228.8 KB), Throughput: 45.4G rows/s, CPU Time per worker: avg 1.1 ms, max 1.3 ms, Wall Time: 7.0 us                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                │     Filtered: 0.0%, QError: 80.0                                                                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                │     Dynamic Filters Builder: {d_date_sk}                                                                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                └─ Broadcast Exchange                                                                                                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   │     Est. 366 rows, cost 6.0e+04                                                                                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   └─ Filter                                                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     Est. 366 rows, cost 5.9e+04                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     Act. 366 rows (6.1 KB), Throughput: 85.1M rows/s, CPU Time per worker: avg 282.0 us, max 283.0 us, Wall Time: 44.0 us                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     Filtered: 0.0%, QError: 1.0                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      │     d_year = 2000                                                                                                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      └─ ReadFromStorage tpcds.date_dim                                                                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                               Est. 71.3K rows, cost 5.4e+04                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                               Act. 366 rows (6.1 KB), Throughput: 85.1M rows/s, CPU Time per worker: avg 780.0 us, max 840.0 us, Wall Time: 43.0 us                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                               Filtered: 0.0%, QError: 199.6                                                                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ note: Dynamic Filter is applied for 1 times.                                                                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ note: CTE(Common Table Expression) is applied for 2 times.                                                                                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Explain analyze distributed + SQL</p><div class="codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-text codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN ANALYZE DISTRIBUTED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i_item_id,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg(ss_quantity) AS agg1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg(ss_list_price) AS agg2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg(ss_coupon_amt) AS agg3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg(ss_sales_price) AS agg4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM store_sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">, customer_demographics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">, date_dim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">, item</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">, promotion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE (ss_sold_date_sk = d_date_sk) AND (ss_item_sk = i_item_sk) AND (ss_cdemo_sk = cd_demo_sk) AND (ss_promo_sk = p_promo_sk) AND (cd_gender = &#x27;M&#x27;) AND (cd_marital_status = &#x27;S&#x27;) AND (cd_education_status = &#x27;College&#x27;) AND ((p_channel_email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> = &#x27;N&#x27;) OR (p_channel_event = &#x27;N&#x27;)) AND (d_year = 2000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GROUP BY i_item_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ORDER BY i_item_id ASC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIMIT 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/en/assets/images/boxcnxiwhbhVnUQkflLLELMblMb-53e97bb3ff821485ece57e29df406c24.png" width="2290" height="1694" class="img_astN"></p><ul><li>QError: max(Est rows, Act rows) / min(Est rows, Act rows), 1 is the best.</li><li>Wall Time: max wall time of all the workers. We can figure out which step takes the most time.</li><li>CPU Time: We can figure out which step has the data skew issue. (If the max time is bigger than avg time, there is one worker which processed too much data.)</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_HAaO padding--none margin-left--sm"><li class="tag_Ut5_"><a class="tag_sQub tagRegular_dfhI" href="/en/docs/tags/docs">Docs</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/inos2023/blog/docs/advanced-guide/query-optimiser.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_O9Og" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_DEFe"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/advanced-guide/managing-concurrency"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Transactions and Concurrency Control</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/advanced-guide/rbac"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Role-based Access Control (RBAC)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Q7NC thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#syntax-definition" class="table-of-contents__link toc-highlight">Syntax Definition</a></li><li><a href="#syntax-example" class="table-of-contents__link toc-highlight">Syntax Example:</a><ul><li><a href="#create-statistics" class="table-of-contents__link toc-highlight">Create Statistics</a></li><li><a href="#show-statistics" class="table-of-contents__link toc-highlight">Show Statistics</a></li><li><a href="#drop-statistics" class="table-of-contents__link toc-highlight">Drop Statistics</a></li></ul></li><li><a href="#explain" class="table-of-contents__link toc-highlight">Explain</a></li><li><a href="#explain-analyze" class="table-of-contents__link toc-highlight"><strong>Explain Analyze</strong></a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 ZJLab.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.dd42e63f.js"></script>
<script src="/en/assets/js/main.bb7ada30.js"></script>
</body>
</html>